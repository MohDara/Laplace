<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laplace Transform Cheatsheet</title>
    <script>
        // Configure MathJax BEFORE loading it
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: { // Using SVG output can sometimes be more consistent
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js">
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #00ffff;
            box-shadow: 0 0 20px rgba(0,255,255,0.3);
        }
        
        .section-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .nav-btn {
            background: rgba(255,255,255,0.1);
            border: 2px solid #00ffff;
            color: #00ffff;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .nav-btn:hover, .nav-btn.active {
            background: #00ffff;
            color: #1e3c72;
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0,255,255,0.5);
        }
        
        .section {
            display: none;
            background: rgba(0,0,0,0.4);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid rgba(255,255,255,0.2);
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .formula-box {
            background: rgba(0,255,255,0.1);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 20px;
            margin: 25px 0;
            font-size: 18px;
            text-align: center;
            box-shadow: 0 0 10px rgba(0,255,255,0.2);
        }
        
        .step-box {
            background: rgba(255,255,255,0.1);
            border-left: 4px solid #4ecdc4;
            padding: 15px 20px; /* Adjusted padding */
            margin: 15px 0; /* Adjusted margin */
            border-radius: 0 10px 10px 0;
            display: flex; /* For aligning step number and text */
            align-items: center; /* For aligning step number and text */
            font-size: 16px; /* Adjusted font size for steps */
        }
        
        .step-number {
            background: #4ecdc4;
            color: #1e3c72;
            min-width: 30px; /* Use min-width */
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            font-size: 16px; /* Ensure number fits */
        }
        
        .formula-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .formula-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid #4ecdc4;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: transform 0.3s ease;
            font-size: 16px; /* Adjusted font size */
        }
        
        .formula-card:hover {
            transform: scale(1.02);
            box-shadow: 0 0 15px rgba(78,205,196,0.3);
        }
        
        .problem-type {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
            font-size: 18px;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .warning {
            background: rgba(255,193,7,0.2);
            border: 2px solid #ffc107;
            color: #ffc107;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
        }
        
        h2 {
            color: #00ffff;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            text-shadow: 0 0 10px rgba(0,255,255,0.5);
        }
        
        .mjx-chtml { /* For MathJax v3 with CHTML output */
            color: inherit !important;
            font-size: 1.1em; /* Slightly larger math font */
        }
        mjx-container { /* General MathJax container */
             text-align: center !important; /* Center display math */
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .theorem-box {
            background: rgba(138, 43, 226, 0.2); /* Purple-ish */
            border: 2px solid #8a2be2; /* Violet */
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-size: 17px; /* Adjusted font size */
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>LAPLACE TRANSFORM CHEATSHEET</h1>
        </div>
        
        <div class="section-nav">
            <button class="nav-btn active" onclick="showSection('basic', event)">Basic Transforms</button>
            <button class="nav-btn" onclick="showSection('inverse', event)">Inverse Transforms</button>
            <button class="nav-btn" onclick="showSection('derivatives', event)">Derivative Problems</button>
            <button class="nav-btn" onclick="showSection('translation', event)">Translation Theorems</button>
            <button class="nav-btn" onclick="showSection('stepfunc', event)">Step Functions</button>
            <button class="nav-btn" onclick="showSection('operational', event)">Operational Properties</button>
            <button class="nav-btn" onclick="showSection('systems', event)">System of ODEs</button>
            <button class="nav-btn" onclick="showSection('identities', event)">Essential Identities</button>
        </div>
        
        <!-- Basic Transforms Section -->
        <div id="basic" class="section active">
            <h2>4.1: Definition of the Laplace Transform</h2>
            
            <div class="formula-box">
                $$\mathcal{L}\{f(t)\} = F(s) = \int_0^{\infty} e^{-st} f(t) \, dt$$
            </div>
            
            <div class="formula-grid">
                <div class="formula-card">$\mathcal{L}\{1\} = \frac{1}{s}$</div>
                <div class="formula-card">$\mathcal{L}\{t\} = \frac{1}{s^2}$</div>
                <div class="formula-card">$\mathcal{L}\{t^n\} = \frac{n!}{s^{n+1}}$ (n = integer $\ge 0$)</div>
                <div class="formula-card">$\mathcal{L}\{e^{at}\} = \frac{1}{s-a}$</div>
                <div class="formula-card">$\mathcal{L}\{\sin(kt)\} = \frac{k}{s^2+k^2}$</div>
                <div class="formula-card">$\mathcal{L}\{\cos(kt)\} = \frac{s}{s^2+k^2}$</div>
                <div class="formula-card">$\mathcal{L}\{\sinh(kt)\} = \frac{k}{s^2-k^2}$</div>
                <div class="formula-card">$\mathcal{L}\{\cosh(kt)\} = \frac{s}{s^2-k^2}$</div>
            </div>
            
            <div class="problem-type">LINEARITY</div>
            <div class="formula-box">
                $$\mathcal{L}\{\alpha f(t) + \beta g(t)\} = \alpha \mathcal{L}\{f(t)\} + \beta \mathcal{L}\{g(t)\}$$
            </div>
            
            <div class="step-box">
                <span class="step-number">١</span> تحديد الحدود
            </div>
            <div class="step-box">
                <span class="step-number">٢</span> تحويل كل حد
            </div>
            <div class="step-box">
                <span class="step-number">٣</span> جمع النتائج
            </div>
        </div>
        
        <!-- Inverse Transforms Section -->
        <div id="inverse" class="section">
            <h2>4.2: The Inverse Transform</h2>
            
            <div class="formula-box">
                $$f(t) = \mathcal{L}^{-1}\{F(s)\}$$
            </div>
            
            <div class="formula-grid">
                <div class="formula-card">$\mathcal{L}^{-1}\left\{\frac{1}{s}\right\} = 1$</div>
                <div class="formula-card">$\mathcal{L}^{-1}\left\{\frac{n!}{s^{n+1}}\right\} = t^n$ (n = integer $\ge 0$)</div>
                <div class="formula-card">$\mathcal{L}^{-1}\left\{\frac{1}{s-a}\right\} = e^{at}$</div>
                <div class="formula-card">$\mathcal{L}^{-1}\left\{\frac{k}{s^2+k^2}\right\} = \sin(kt)$</div>
                <div class="formula-card">$\mathcal{L}^{-1}\left\{\frac{s}{s^2+k^2}\right\} = \cos(kt)$</div>
                <div class="formula-card">$\mathcal{L}^{-1}\left\{\frac{k}{s^2-k^2}\right\} = \sinh(kt)$</div>
                <div class="formula-card">$\mathcal{L}^{-1}\left\{\frac{s}{s^2-k^2}\right\} = \cosh(kt)$</div>
            </div>
            
            <div class="problem-type">PARTIAL FRACTIONS</div>
            <div class="step-box">
                <span class="step-number">١</span> تحليل المقام
            </div>
            <div class="step-box">
                <span class="step-number">٢</span> إعداد الكسور
            </div>
            <div class="step-box">
                <span class="step-number">٣</span> إيجاد الثوابت $A, B, C \dots$
            </div>
            <div class="step-box">
                <span class="step-number">٤</span> تحويل عكسي لكل كسر
            </div>
        </div>
        
        <!-- Derivatives Section -->
        <div id="derivatives" class="section">
            <h2>Transforms of Derivatives</h2>
            
            <div class="formula-grid">
                <div class="formula-card">$\mathcal{L}\{f'(t)\} = sF(s) - f(0)$</div>
                <div class="formula-card">$\mathcal{L}\{f''(t)\} = s^2F(s) - sf(0) - f'(0)$</div>
                <div class="formula-card">$\mathcal{L}\{f^{(n)}(t)\} = s^nF(s) - s^{n-1}f(0) - \dots - f^{(n-1)}(0)$</div>
            </div>
            
            <div class="problem-type">INITIAL VALUE PROBLEMS</div>
            <div class="step-box">
                <span class="step-number">١</span> تحويل لابلاس للمعادلة
            </div>
            <div class="step-box">
                <span class="step-number">٢</span> تعويض الشروط الابتدائية
            </div>
            <div class="step-box">
                <span class="step-number">٣</span> حل لـ $Y(s)$
            </div>
            <div class="step-box">
                <span class="step-number">٤</span> تحويل عكسي لـ $y(t)$
            </div>
        </div>
        
        <!-- Translation Theorems Section -->
        <div id="translation" class="section">
            <h2>4.3: Translation Theorems</h2>
            
            <div class="problem-type">FIRST TRANSLATION THEOREM (s-SHIFTING)</div>
            <div class="theorem-box">
                <div class="two-column">
                    <div>$$\mathcal{L}\{e^{at}f(t)\} = F(s-a)$$</div>
                    <div>$$\mathcal{L}^{-1}\{F(s-a)\} = e^{at}f(t)$$ where $f(t) = \mathcal{L}^{-1}\{F(s)\}$</div>
                </div>
            </div>
            
            <div class="step-box">
                <span class="step-number">١</span> تحديد $e^{at}$
            </div>
            <div class="step-box">
                <span class="step-number">٢</span> $s \rightarrow (s-a)$ في التحويل (أو العكس للتحويل العكسي)
            </div>
            
            <div class="problem-type">COMPLETING THE SQUARE (for Inverse Transforms)</div>
            <div class="step-box">
                <span class="step-number">١</span> إكمال المربع في المقام: $s^2 + bs + c = \left(s + \frac{b}{2}\right)^2 + \left(c - \frac{b^2}{4}\right)$
            </div>
            <div class="step-box">
                <span class="step-number">٢</span> تطبيق نظرية الإزاحة الأولى
            </div>
        </div>
        
        <!-- Step Functions Section -->
        <div id="stepfunc" class="section">
            <h2>Unit Step Functions (Heaviside Function)</h2>
            
            <div class="formula-box">
                $$u(t-a) = \begin{cases} 0 & \text{if } 0 \leq t < a \\ 1 & \text{if } t \geq a \end{cases} \quad (a \ge 0)$$
            </div>
             <div class="formula-card" style="margin-bottom: 20px;">$\mathcal{L}\{u(t-a)\} = \frac{e^{-as}}{s}$</div>

            <div class="problem-type">SECOND TRANSLATION THEOREM (t-SHIFTING)</div>
            <div class="theorem-box">
                 <div class="two-column">
                    <div>$\mathcal{L}\{f(t-a)u(t-a)\} = e^{-as}F(s)$</div>
                    <div>$\mathcal{L}^{-1}\{e^{-as}F(s)\} = f(t-a)u(t-a)$</div>
                </div>
                 Where $F(s) = \mathcal{L}\{f(t)\}$.
            </div>
             <div class="formula-box">
                Alternative form: $\mathcal{L}\{g(t)u(t-a)\} = e^{-as}\mathcal{L}\{g(t+a)\}$
            </div>
            
            <div class="step-box">
                <span class="step-number">١</span> كتابة الدالة $g(t)$ بدلالة $f(t-a)u(t-a)$ أو استخدام الصيغة البديلة
            </div>
            <div class="step-box">
                <span class="step-number">٢</span> إيجاد $F(s)=\mathcal{L}\{f(t)\}$ (أو $\mathcal{L}\{g(t+a)\}$)
            </div>
            <div class="step-box">
                <span class="step-number">٣</span> ضرب في $e^{-as}$
            </div>
        </div>
        
        <!-- Operational Properties Section -->
        <div id="operational" class="section">
            <h2>4.4: Additional Operational Properties</h2>
            
            <div class="problem-type">DERIVATIVES OF TRANSFORMS (MULTIPLICATION BY $t^n$)</div>
            <div class="formula-box">
                $$\mathcal{L}\{t^n f(t)\} = (-1)^n \frac{d^n}{ds^n} F(s)$$
                For $n=1$: $\mathcal{L}\{t f(t)\} = -\frac{dF(s)}{ds}$
            </div>
            <div style="text-align: center; margin-bottom:10px;">Steps for $n=1$:</div>
            <div class="step-box">
                <span class="step-number">١</span> إيجاد $F(s) = \mathcal{L}\{f(t)\}$
            </div>
            <div class="step-box">
                <span class="step-number">٢</span> اشتقاق $F(s)$ (مرة واحدة)
            </div>
            <div class="step-box">
                <span class="step-number">٣</span> ضرب في $(-1)$
            </div>
            
            <div class="problem-type">INTEGRALS OF TRANSFORMS (DIVISION BY $t$)</div>
            <div class="formula-box">
                $$\text{If } \lim_{t\to 0^+} \frac{f(t)}{t} \text{ exists, then } \mathcal{L}\left\{\frac{f(t)}{t}\right\} = \int_s^\infty F(\sigma) \, d\sigma$$
            </div>

            <div class="problem-type">CONVOLUTION</div>
            <div class="theorem-box">
                <div>Definition: $(f * g)(t) = \int_0^t f(\tau)g(t-\tau) \, d\tau$$</div>
                <div>Property: $$\mathcal{L}\{(f * g)(t)\} = F(s)G(s)$$</div>
                <div>Inverse Property: $$\mathcal{L}^{-1}\{F(s)G(s)\} = (f * g)(t)$$</div>
            </div>
            
            <div class="problem-type">TRANSFORM OF AN INTEGRAL</div>
            <div class="theorem-box">
                <div>$$\mathcal{L}\left\{\int_0^t f(\tau) \, d\tau\right\} = \frac{F(s)}{s}$$</div>
                <div>$$\mathcal{L}^{-1}\left\{\frac{F(s)}{s}\right\} = \int_0^t f(\tau) \, d\tau$$</div>
                <div>(Note: This is $(1*f)(t)$, so $\mathcal{L}\{(1*f)(t)\} = \mathcal{L}\{1\}\mathcal{L}\{f(t)\} = \frac{1}{s}F(s)$)</div>
            </div>

            <div class="problem-type">TRANSFORM OF PERIODIC FUNCTIONS</div>
            <div class="theorem-box">
                If $f(t)$ is periodic with period $T > 0$ (i.e., $f(t+T) = f(t)$ for $t \ge 0$), then:
                $$\mathcal{L}\{f(t)\} = \frac{\int_0^T e^{-st} f(t) \, dt}{1 - e^{-sT}}$$
            </div>

            <div class="problem-type">DIRAC DELTA FUNCTION (IMPULSE FUNCTION)</div>
             <div class="formula-box">
                Definition: $\delta(t-a) = 0$ for $t \ne a$, and $\int_{-\infty}^\infty \delta(t-a) dt = 1$.
                <br>For Laplace transforms, typically $a \ge 0$. $\int_0^\infty g(t)\delta(t-a) dt = g(a)$ if $a>0$.
                $$\mathcal{L}\{\delta(t-a)\} = e^{-as} \quad (a \ge 0)$$
                Special case: $\mathcal{L}\{\delta(t)\} = 1$
            </div>
            <div class="theorem-box">
                Sifting property: $\int_0^\infty g(t)\delta(t-a) dt = g(a)$ for $a \ge 0$ (if $a=0$, integral is often taken from $0^-$ or assumes $g(t)$ continuous at $0$).
                $$\mathcal{L}\{f(t)\delta(t-a)\} = e^{-as}f(a) \quad (a \ge 0)$$
            </div>

            <div class="problem-type">GAMMA FUNCTION (Generalization for $\mathcal{L}\{t^p\}$)</div>
             <div class="formula-box">
                $$\mathcal{L}\{t^p\} = \frac{\Gamma(p+1)}{s^{p+1}} \quad (p > -1)$$
                Where $\Gamma(z) = \int_0^\infty x^{z-1}e^{-x} dx$.
                <br>Properties: $\Gamma(p+1) = p\Gamma(p)$.
                <br>For integer $n \ge 0$: $\Gamma(n+1) = n!$.
                <br>Example: $\Gamma(1/2) = \sqrt{\pi}$. So $\mathcal{L}\{t^{-1/2}\} = \mathcal{L}\{1/\sqrt{t}\} = \frac{\Gamma(1/2)}{s^{1/2}} = \sqrt{\frac{\pi}{s}}$.
            </div>
        </div>
        
        <!-- Systems Section -->
        <div id="systems" class="section">
            <h2>4.6: Systems of Linear Differential Equations</h2>
            <div style="text-align: center; margin-bottom:10px;">Example System:
                $x' = ax + by + f(t)$ <br>
                $y' = cx + dy + g(t)$ <br>
                With initial conditions $x(0)=x_0, y(0)=y_0$.
            </div>
            <div style="text-align: center; margin-bottom:20px;">Transformed System:
                $sX(s) - x_0 = aX(s) + bY(s) + F(s)$ <br>
                $sY(s) - y_0 = cX(s) + dY(s) + G(s)$
            </div>

            <div class="step-box">
                <span class="step-number">١</span> تحويل لابلاس لكل معادلة
            </div>
            <div class="step-box">
                <span class="step-number">٢</span> تعويض الشروط الابتدائية
            </div>
            <div class="step-box">
                <span class="step-number">٣</span> حل النظام لـ $X(s), Y(s)$ (e.g., using Cramer's rule or substitution)
            </div>
            <div class="step-box">
                <span class="step-number">٤</span> تحويل عكسي لـ $x(t), y(t)$
            </div>
            
            <div class="warning">
                Be careful with algebraic manipulation when solving for $X(s)$ and $Y(s)$.
            </div>
        </div>

        <!-- Essential Identities Section -->
        <div id="identities" class="section">
            <h2>Essential Identities</h2>
            
            <div class="problem-type">TRIGONOMETRIC IDENTITIES</div>
            <div class="formula-grid">
                <div class="formula-card">$\sin^2\theta + \cos^2\theta = 1$</div>
                <div class="formula-card">$\tan^2\theta + 1 = \sec^2\theta$</div>
                <div class="formula-card">$1 + \cot^2\theta = \csc^2\theta$</div>
                <div class="formula-card">$\sin(2\theta) = 2\sin\theta\cos\theta$</div>
                <div class="formula-card">$\cos(2\theta) = \cos^2\theta - \sin^2\theta$</div>
                <div class="formula-card">$\cos(2\theta) = 2\cos^2\theta - 1$</div>
                <div class="formula-card">$\cos(2\theta) = 1 - 2\sin^2\theta$</div>
                <div class="formula-card">$\sin^2\theta = \frac{1 - \cos(2\theta)}{2}$</div>
                <div class="formula-card">$\cos^2\theta = \frac{1 + \cos(2\theta)}{2}$</div>
                <div class="formula-card">$\sin(A \pm B) = \sin A \cos B \pm \cos A \sin B$</div>
                <div class="formula-card">$\cos(A \pm B) = \cos A \cos B \mp \sin A \sin B$</div>
                <div class="formula-card">$\tan(A \pm B) = \frac{\tan A \pm \tan B}{1 \mp \tan A \tan B}$</div>
                 <div class="formula-card">$2\sin A \cos B = \sin(A+B) + \sin(A-B)$</div>
                 <div class="formula-card">$2\cos A \sin B = \sin(A+B) - \sin(A-B)$</div>
                 <div class="formula-card">$2\cos A \cos B = \cos(A+B) + \cos(A-B)$</div>
                 <div class="formula-card">$2\sin A \sin B = \cos(A-B) - \cos(A+B)$</div>
            </div>
            
            <div class="problem-type">HYPERBOLIC DEFINITIONS & IDENTITIES</div>
            <div class="formula-grid">
                <div class="formula-card">$\sinh x = \frac{e^x - e^{-x}}{2}$</div>
                <div class="formula-card">$\cosh x = \frac{e^x + e^{-x}}{2}$</div>
                <div class="formula-card">$\tanh x = \frac{\sinh x}{\cosh x} = \frac{e^x - e^{-x}}{e^x + e^{-x}}$</div>
                <div class="formula-card">$\cosh^2 x - \sinh^2 x = 1$</div>
                 <div class="formula-card">$e^{x} = \cosh x + \sinh x$</div>
                 <div class="formula-card">$e^{-x} = \cosh x - \sinh x$</div>
                 <div class="formula-card">$\sinh(2x) = 2\sinh x \cosh x$</div>
                 <div class="formula-card">$\cosh(2x) = \cosh^2 x + \sinh^2 x$</div>
            </div>
             <div class="problem-type">EULER'S FORMULA</div>
             <div class="formula-box">
                $$e^{i\theta} = \cos\theta + i\sin\theta$$
                $$\cos\theta = \frac{e^{i\theta} + e^{-i\theta}}{2}$$
                $$\sin\theta = \frac{e^{i\theta} - e^{-i\theta}}{2i}$$
            </div>
        </div>

    </div>
    
    <script>
        // Function to handle MathJax typesetting
        function doMathJaxTypeset() {
            if (typeof MathJax !== "undefined" && MathJax.typesetPromise) {
                // console.log("Attempting MathJax typeset.");
                MathJax.typesetPromise().catch((err) => console.error('MathJax typesetting error:', err));
            } else {
                // console.warn('MathJax or typesetPromise not available for typesetting at this moment.');
            }
        }

        function showSection(sectionId, event) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            
            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected section
            const currentSection = document.getElementById(sectionId);
            if (currentSection) {
                currentSection.classList.add('active');
            }
            
            // Add active class to clicked button
            if (event && event.currentTarget) { // Use event.currentTarget for reliability
                 event.currentTarget.classList.add('active');
            } else {
                // Fallback if event is not passed or target is unreliable
                const correspondingButton = document.querySelector(`.nav-btn[onclick*="showSection('${sectionId}'"]`);
                if (correspondingButton) {
                    correspondingButton.classList.add('active');
                }
            }
            
            // Re-render MathJax for the new section
            doMathJaxTypeset();
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.formula-card, .theorem-box, .formula-box');
            cards.forEach(card => {
                const originalBackground = card.style.background;
                card.addEventListener('mouseenter', function() {
                    if (card.classList.contains('formula-card')) this.style.background = 'rgba(78,205,196,0.3)'; // Brighter aqua
                    else if (card.classList.contains('theorem-box')) this.style.background = 'rgba(138, 43, 226, 0.35)'; // Brighter purple
                    else if (card.classList.contains('formula-box')) this.style.background = 'rgba(0,255,255,0.2)'; // Brighter cyan
                });
                card.addEventListener('mouseleave', function() {
                    this.style.background = originalBackground; // Revert to original or specific default
                     if (card.classList.contains('formula-card')) this.style.background = 'rgba(255,255,255,0.1)';
                     else if (card.classList.contains('theorem-box')) this.style.background = 'rgba(138, 43, 226, 0.2)';
                     else if (card.classList.contains('formula-box')) this.style.background = 'rgba(0,255,255,0.1)';
                });
            });
            
            // Initial MathJax rendering
            if (window.MathJax && MathJax.startup && MathJax.startup.promise) {
                 MathJax.startup.promise.then(() => {
                    // console.log('MathJax is ready via startup.promise. Initial typesetting.');
                    doMathJaxTypeset(); 
                 }).catch((err) => console.error('MathJax startup error:', err));
            } else if (window.MathJax && MathJax.typesetPromise) {
                // console.log('MathJax seems ready (no startup.promise). Initial typesetting.');
                doMathJaxTypeset();
            } else {
                 // Fallback: if MathJax takes longer to load async, retry after a short delay
                setTimeout(() => {
                    // console.log('Retrying initial typeset after delay.');
                    doMathJaxTypeset();
                }, 1000); // Wait 1 sec
                if (!document.getElementById('MathJax-script')) {
                    console.error('MathJax script tag not found.');
                } else {
                    console.warn('MathJax not immediately available for initial typeset. Will retry.');
                }
            }

            // Ensure the first section's button is correctly styled
            const activeSection = document.querySelector('.section.active');
            if (activeSection) {
                const activeButton = document.querySelector(`.nav-btn[onclick*="showSection('${activeSection.id}'"]`);
                if (activeButton && !activeButton.classList.contains('active')) {
                    document.querySelectorAll('.nav-btn.active').forEach(b => b.classList.remove('active'));
                    activeButton.classList.add('active');
                }
            }
        });
    </script>
</body>
</html>